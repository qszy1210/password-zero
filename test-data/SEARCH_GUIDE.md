# 密码库搜索功能使用指南

## 功能概述

在解密 tab 中新增了强大的搜索功能，可以对解密后的 JSON 数据进行快速检索和过滤。

## 数据格式要求

解密后的数据应为 JSON 格式的对象数组，每个对象支持以下字段：

```json
[
  {
    "uuid": "唯一标识符",
    "title": "标题",
    "username": "用户名",
    "password": "密码",
    "info": "备注信息",
    "created": "创建时间",
    "modified": "修改时间"
  }
]
```

## 使用步骤

### 1. 解密数据
- 在"解密数据" tab 中，导入加密文件或粘贴加密数据
- 输入主密码并点击"🔑 解密"按钮
- 解密成功后会显示"🔍 结果搜索"按钮

### 2. 打开搜索界面
- 点击"🔍 结果搜索"按钮
- 会打开一个独立的搜索模态框
- 自动解析 JSON 数据并显示所有记录

### 3. 搜索功能

#### 默认搜索
- 搜索框中输入关键词
- 默认在 `title`、`username`、`info` 三个字段中搜索
- 支持实时搜索，输入即搜索

#### 指定字段搜索
- 使用右侧下拉菜单选择特定字段
- 可选字段：
  - 默认搜索字段（title + username + info）
  - 仅搜索 title
  - 仅搜索 username
  - 仅搜索 info
  - 仅搜索 uuid
  - 仅搜索 password
  - 仅搜索 created
  - 仅搜索 modified

#### 🆕 连续/非连续匹配切换
- 使用"连续匹配"复选框切换匹配模式
- **未勾选（默认）**：非连续匹配模式
  - `af` 可以匹配 `asdf78`（a...f 顺序一致）
  - `af` 可以匹配 `afda88`（a...f 顺序一致）
  - 更灵活，适合模糊搜索
- **勾选**：连续匹配模式
  - `af` 只匹配包含连续 `af` 的文本（如 `77afda88`）
  - `af` 不匹配 `asdf78`（a 和 f 不连续）
  - 更精确，适合精准搜索

### 4. 模糊匹配规则

#### 非连续匹配（默认）

搜索采用**部分匹配**算法，即使字符不连贯，只要顺序一致也能匹配：

##### 示例：
- 输入：`af`
- 可以匹配：
  - `asdf78` ✅ (a...f 顺序一致)
  - `77afda88` ✅ (a...f 顺序一致)
  - `GitHub` ❌ (没有按顺序的 a 和 f)

##### 中文支持：
- 输入：`阿云`
- 可以匹配：`阿里云账号` ✅

#### 连续匹配

只匹配完全连续的字符序列：

##### 示例：
- 输入：`af`（勾选"连续匹配"）
- 可以匹配：
  - `77afda88` ✅ (包含连续的 af)
  - `test_af_user` ✅ (包含连续的 af)
  - `asdf78` ❌ (a 和 f 不连续)

### 5. 搜索结果展示

- 显示匹配结果数量统计
- 匹配的字符会以**黄色高亮**显示
  - 非连续模式：每个匹配字符单独高亮
  - 连续模式：整个匹配子串高亮
- 密码默认显示为 `********`
- 点击密码可以显示/隐藏明文
- 优化的紧凑布局，减少横向空间占用

### 6. 关闭搜索
- 点击右上角 `×` 按钮
- 点击模态框外部区域
- 按 `ESC` 键

## 测试数据

项目提供了两个测试文件：

### 1. `test-data.json` - 基础测试
包含 5 条示例记录：
- GitHub 账号
- Google 邮箱
- AWS 控制台
- 阿里云账号
- 数据库密码

### 2. `test-continuous-search.json` - 连续匹配测试
包含 6 条特殊设计的记录，用于测试连续/非连续匹配：
- 包含 `asdf78` 的标题（测试非连续匹配）
- 包含 `77afda88` 的信息（测试连续匹配）
- 包含 `test_af_user` 的用户名（测试连续匹配）

### 测试步骤：

1. 复制测试文件的内容
2. 在加密 tab 中粘贴到"输入要加密的文本"
3. 设置主密码（例如：`test123`）
4. 点击"🔐 加密"
5. 点击"💾 导出文件"保存加密文件
6. 切换到解密 tab
7. 导入刚才保存的加密文件
8. 输入主密码 `test123` 并解密
9. 点击"🔍 结果搜索"开始测试

### 测试用例：

#### 非连续匹配测试（不勾选"连续匹配"）

| 输入关键词 | 搜索字段 | 预期匹配 | 说明 |
|-----------|---------|---------|------|
| `af` | 默认 | 数据库密码、测试账号 | 匹配 asdf78, afda88, af |
| `git` | 默认 | GitHub 账号 | 模糊匹配 |
| `admin` | 默认 | AWS 控制台, 数据库密码 | 匹配 admin, administrator |
| `阿云` | 默认 | 阿里云账号 | 中文模糊匹配 |
| `ae` | username | developer@example.com | 顺序字符匹配 |

#### 连续匹配测试（勾选"连续匹配"）

| 输入关键词 | 搜索字段 | 预期匹配 | 说明 |
|-----------|---------|---------|------|
| `af` | 默认 | 测试账号 | 只匹配连续的 af（test_af_user, 77afda88） |
| `asdf` | 默认 | 数据库密码 | 匹配 asdf78 |
| `git` | 默认 | GitHub 账号 | 连续子串匹配 |
| `阿里` | 默认 | 阿里云账号 | 中文连续匹配 |

## 界面特性

✨ **现代化设计**
- 渐变色头部
- 平滑动画效果
- 悬停高亮
- 紧凑优化的布局

🎨 **视觉反馈**
- 黄色高亮匹配文本
- 空状态友好提示
- 结果数量统计
- 匹配模式切换

🔒 **安全性**
- 密码默认隐藏
- 点击查看明文
- 无数据泄露

📱 **响应式布局**
- 支持桌面端
- 支持移动端
- 自适应屏幕

## 技术实现

### 核心算法

#### 非连续匹配算法 (`fuzzyMatch` - continuous=false)：
```javascript
// 遍历文本，按顺序查找查询字符
// 示例：af 匹配 asdf78
// a 在位置 0 找到，f 在位置 3 找到
// 顺序一致，匹配成功
```

#### 连续匹配算法 (`fuzzyMatch` - continuous=true)：
```javascript
// 使用 indexOf 查找连续子串
// 示例：af 只匹配包含连续 "af" 的文本
// "77afda88" 匹配 ✅
// "asdf78" 不匹配 ❌
```

#### 高亮显示 (`highlightMatch`)：
```javascript
// 非连续模式：将每个匹配字符用 <span> 包裹
// 连续模式：将整个匹配子串用 <span> 包裹
// 显示为黄色背景
```

### 性能优化

- 实时搜索（无需点击搜索按钮）
- 高效的字符串匹配算法
- DOM 操作优化
- 紧凑的布局减少渲染开销

## UI/UX 优化

### 布局优化（v2.0）

- ✅ 搜索结果卡片 padding 从 `14px` 减少到 `10px 12px`
- ✅ 字段间距 margin 从 `6px` 减少到 `4px`
- ✅ 字段 gap 从 `8px` 减少到 `6px`
- ✅ 标签最小宽度从 `80px` 减少到 `70px`
- ✅ 标题间距 margin 从 `8px` 减少到 `6px`
- ✅ 更紧凑的视觉效果，提升信息密度

## 注意事项

1. ⚠️ 解密数据必须是有效的 JSON 格式
2. ⚠️ 数据格式应该是对象数组
3. ⚠️ 搜索不区分大小写
4. ⚠️ 密码字段点击后会显示明文，注意保护隐私
5. ⚠️ 连续匹配更精确但可能错过一些结果
6. ⚠️ 非连续匹配更灵活但可能包含意外结果

## 快捷键

| 快捷键 | 功能 |
|-------|------|
| `ESC` | 关闭搜索模态框 |
| `Enter`（密码框） | 快速解密 |

## 版本历史

### v2.0 (2024-11-11)
- ✨ 新增连续/非连续匹配切换功能
- 🎨 优化搜索结果布局，减少横向空间占用
- 📊 改进高亮显示逻辑，支持两种匹配模式
- 📝 新增测试数据文件用于验证匹配功能

### v1.0 (2024-11-11)
- 🎉 初始版本发布
- 🔍 基础模糊搜索功能
- 🎯 字段筛选功能
- 💡 实时搜索
- 🎨 现代化 UI 设计

## 未来改进

- [ ] 添加正则表达式搜索
- [ ] 支持多字段组合搜索
- [ ] 添加排序功能
- [ ] 导出搜索结果
- [ ] 搜索历史记录
- [ ] 保存常用搜索条件
- [ ] 支持搜索结果批量操作

